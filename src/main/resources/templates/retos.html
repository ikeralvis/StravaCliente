<!-- (Code generated by ChatGPT 4o mini) -->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<title>Retos</title>
	<!-- Bootstrap JS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<!-- Font-awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-light">
	<!-- Header with logo and name -->
	<header class="bg-light shadow-sm">
	    <div class="container py-2 text-center">
	        <a href="/index" class="text-decoration-none text-dark">
	            <i class="fas fa-dumbbell fa-2x me-2"></i>
	            <span class="fs-4" style="color: #4a4a4a;">Strava APP</span>
	        </a>
	    </div>
	</header>

	<!-- Navigation bar -->
	<nav class="navbar navbar-light bg-light shadow-sm">
		<div class="container">
			 <!-- Links de navegacion -->
			 <a href="/entrenamientos" class="btn btn-dark fw-bold me-2">Mis entrenamientos</a>
			 <a href="/retos" class="btn btn-dark fw-bold me-2">Retos</a>

	        <!-- Logout button -->
	        <div class="ms-auto">
	            	<a th:if="${token != null}" th:href="@{/logout(redirectUrl=${currentUrl})}" 
	               	class="btn btn-danger btn-sm d-flex align-items-center ms-2">
	                <i class="fas fa-sign-out-alt me-2"></i> Logout
	            	</a>
				</div>
	        </div>
	    </div>
	</nav>

	<!-- Content -->
    <main class="container my-4">
        <h1 class="text-center mb-4">Retos</h1>

        <!-- Tabla de retos -->
        <h2 class="mt-5">Retos Disponibles</h2>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Nombre</th>
                        <th>Deporte</th>
                        <th>Objetivo Distancia (km)</th>
                        <th>Objetivo Tiempo (min)</th>
                        <th>Fecha Inicio</th>
                        <th>Fecha Fin</th>
                        <th>Acción</th> <!-- Nueva columna para el botón de aceptar -->
                    </tr>
                </thead>
                <tbody>
                    <!-- Ejemplo de fila, se debería rellenar dinámicamente -->
                    <tr th:each="reto : ${retos}">
                        <td th:text="${reto.nombre}"></td>
                        <td th:text="${reto.deporte}"></td>
                        <td th:text="${reto.objetivoDistancia}"></td>
                        <td th:text="${reto.objetivoTiempo}"></td>
                        <td th:text="${reto.fechaInicio}"></td>
                        <td th:text="${reto.fechaFin}"></td>
                        <td>
                            <!-- Botón de aceptar -->
                            <form th:action="@{/retos/aceptar}" method="post">
                                <input type="hidden" name="retoNombre" th:value="${reto.nombre}" />
                                <button type="submit" class="btn btn-success">Aceptar</button>
                            </form>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Botones para filtrar retos por deporte o por fecha -->

        <div class="row mt-5">
            <div class="col-12">
            <h3>Filtrar Retos</h3>
            <form th:action="@{/retos}" method="get">
                <div class="row">
                <div class="col-md-5">
                    <label class="form-label">Por Deporte</label>
                    <select name="deporte" class="form-select">
                    <option value="Ciclismo">Ciclismo</option>
                    <option value="Correr">Correr</option>
                    </select>
                </div>
                <div class="col-md-5"></div>
                    <label class="form-label">Por Fecha de Inicio</label>
                    <input type="date" name="fechaInicio" class="form-control">
                </div>
                <div class="col-md-2 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary w-100">Filtrar</button>
                </div>
                </div>
            </form>
            </div>
        </div>

        <!-- Tabla de retos aceptados -->
        <h2 class="mt-5">Mis Retos Aceptados</h2>
        <div class="table-responsive">
            <table class="table table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Nombre</th>
                        <th>Deporte</th>
                        <th>Objetivo Distancia (km)</th>
                        <th>Objetivo Tiempo (min)</th>
                        <th>Fecha Inicio</th>
                        <th>Fecha Fin</th>
                        <th>Progreso</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Ejemplo de fila, se debería rellenar dinámicamente con los retos aceptados -->
                    <tr th:each="retoAceptado : ${retosAceptados}">
                        <td th:text="${retoAceptado.nombre}"></td>
                        <td th:text="${retoAceptado.deporte}"></td>
                        <td th:text="${retoAceptado.objetivoDistancia}"></td>
                        <td th:text="${retoAceptado.objetivoTiempo}"></td>
                        <td th:text="${retoAceptado.fechaInicio}"></td>
                        <td th:text="${retoAceptado.fechaFin}"></td>
                        <td th:text="${#numbers.formatDecimal(T(java.lang.Math).min(retoAceptado.progreso, 100), 1, 2)} + '%'"></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Formulario para añadir retos -->
        <h2 class="mt-5">Añadir Reto</h2>
        <form th:action="@{/reto}" method="post" class="mt-3">
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="nombre" class="form-label">Nombre del Reto</label>
                    <input type="text" id="nombre" name="nombre" class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label for="deporte" class="form-label">Deporte</label>
                    <select id="deporte" name="deporte" class="form-select" required>
                        <option value="Ciclismo">Ciclismo</option>
                        <option value="Correr">Correr</option>
                    </select>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="objetivoDistancia" class="form-label">Objetivo Distancia (km)</label>
                    <input type="number" step="0.01" id="objetivoDistancia" name="objetivoDistancia" class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label for="objetivoTiempo" class="form-label">Objetivo Tiempo (min)</label>
                    <input type="number" id="objetivoTiempo" name="objetivoTiempo" class="form-control" required>
                </div>
            </div>
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="fechaInicio" class="form-label">Fecha de Inicio</label>
                    <input type="date" id="fechaInicio" name="fechaInicio" class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label for="fechaFin" class="form-label">Fecha de Fin</label>
                    <input type="date" id="fechaFin" name="fechaFin" class="form-control" required>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Añadir Reto</button>
        </form>
    </main>

    
	
	<footer style="background-color: #f8f9fa; padding: 15px; text-align: center; border-top: 1px solid #ddd;">
	    <p style="margin: 0; font-size: 14px; color: #333;">			
	        <i class="fas fa-graduation-cap" style="color: #007bff;"></i> 
			Creado por <strong>Iker Alvis y Mikel Garduño</strong>. <strong> Universidad de Deusto </strong>(2024).
	    </p>
	</footer>
	
	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>    
</body>
</html>